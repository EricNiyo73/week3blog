{"version":3,"file":"mustHveAccount.js","names":["dotenv","config","req","res","next","token","headers","authorization","decodedToken","jwt","verify","process","env","JWT_SECRET","user","User","findById","id","status","json","message","err"],"sources":["../../../src/middlewires/mustHveAccount.js"],"sourcesContent":["import jwt from 'jsonwebtoken';\r\nimport  User from \"../models/User.js\";\r\n\r\nimport dotenv from \"dotenv\";\r\ndotenv.config();\r\nexport default async(req, res, next) => {\r\n  try {\r\n    const token = req.headers.authorization;\r\n    \r\n    if(token){\r\n    const decodedToken = jwt.verify(token, process.env.JWT_SECRET);\r\n    const  user  =  await User.findById(decodedToken.id);\r\n      next();\r\n    } else{\r\n      return res.status(401).json({ message: 'please! create an account' });\r\n    }\r\n  \r\n  } catch (err) {\r\n    return res.status(401).json({ message: 'Unauthorized,please Login' });\r\n  }\r\n};"],"mappings":";;;;;;AAAA;AACA;AAEA;AAA4B;AAC5BA,eAAM,CAACC,MAAM,EAAE;AAAC,eACD,OAAMC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACtC,IAAI;IACF,MAAMC,KAAK,GAAGH,GAAG,CAACI,OAAO,CAACC,aAAa;IAEvC,IAAGF,KAAK,EAAC;MACT,MAAMG,YAAY,GAAGC,qBAAG,CAACC,MAAM,CAACL,KAAK,EAAEM,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;MAC9D,MAAOC,IAAI,GAAK,MAAMC,aAAI,CAACC,QAAQ,CAACR,YAAY,CAACS,EAAE,CAAC;MAClDb,IAAI,EAAE;IACR,CAAC,MAAK;MACJ,OAAOD,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEC,OAAO,EAAE;MAA4B,CAAC,CAAC;IACvE;EAEF,CAAC,CAAC,OAAOC,GAAG,EAAE;IACZ,OAAOlB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA4B,CAAC,CAAC;EACvE;AACF,CAAC;AAAA"}