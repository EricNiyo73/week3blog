{"version":3,"file":"users.js","names":["router","Router","put","req","res","body","userId","params","id","password","salt","bcrypt","genSalt","hash","updatedUser","User","findByIdAndUpdate","$set","new","status","json","err","delete","user","findById","findByIdAndDelete","get","_doc","others"],"sources":["../../../src/routes/users.js"],"sourcesContent":["// const router = require(\"express\").Router();\nimport { Router } from 'express';\nconst router = Router();\nimport  User from \"../models/User.js\";\nimport Post from \"../models/Post.js\";\nimport bcrypt from \"bcrypt\";\n\n// sign up\n\n\n\n//UPDATE\nrouter.put(\"/:id\", async (req, res) => {\n  if (req.body.userId === req.params.id) {\n    if (req.body.password) {\n      const salt = await bcrypt.genSalt(10);\n      req.body.password = await bcrypt.hash(req.body.password, salt);\n    }\n    try {\n      const updatedUser = await User.findByIdAndUpdate(\n        req.params.id,\n        {\n          $set: req.body,\n        },\n        { new: true }\n      );\n      return res.status(200).json(updatedUser);\n    } catch (err) {\n      res.status(500).json(err);\n    }\n  } else {\n    return res.status(401).json(\"You can update only your account!\");\n  }\n});\n\n//DELETE\nrouter.delete(\"/:id\", async (req, res) => {\n  if (req.body.userId === req.params.id) {\n    try {\n      const user = await User.findById(req.params.id);\n      await User.findByIdAndDelete(req.params.id);\n       return res.status(200).json(\"User has been deleted...\");\n      // try {\n      //   await Post.deleteMany({ username: user.username });\n      //   await User.findByIdAndDelete(req.params.id);\n      //   return res.status(200).json(\"User has been deleted...\");\n      // } catch (err) {\n      //   return res.status(500).json(err);\n      // }\n    } catch (err) {\n      return res.status(404).json(\"User not found!\");\n    }\n  } else {\n    return res.status(401).json(\"You can delete only your account!\");\n  }\n});\n\n//GET USER\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    const user = await User.findById(req.params.id);\n    const { password, ...others } = user._doc;\n    return res.status(200).json(others);\n  } catch (err) {\n    return res.status(500).json(err);\n  }\n});\n\nexport default router;\n"],"mappings":";;;;;;AACA;AAEA;AACA;AACA;AAA4B;AAAA;AAAA;AAAA;AAH5B,MAAMA,MAAM,GAAG,IAAAC,eAAM,GAAE;AAKvB;;AAIA;AACAD,MAAM,CAACE,GAAG,CAAC,MAAM,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;EACrC,IAAID,GAAG,CAACE,IAAI,CAACC,MAAM,KAAKH,GAAG,CAACI,MAAM,CAACC,EAAE,EAAE;IACrC,IAAIL,GAAG,CAACE,IAAI,CAACI,QAAQ,EAAE;MACrB,MAAMC,IAAI,GAAG,MAAMC,eAAM,CAACC,OAAO,CAAC,EAAE,CAAC;MACrCT,GAAG,CAACE,IAAI,CAACI,QAAQ,GAAG,MAAME,eAAM,CAACE,IAAI,CAACV,GAAG,CAACE,IAAI,CAACI,QAAQ,EAAEC,IAAI,CAAC;IAChE;IACA,IAAI;MACF,MAAMI,WAAW,GAAG,MAAMC,aAAI,CAACC,iBAAiB,CAC9Cb,GAAG,CAACI,MAAM,CAACC,EAAE,EACb;QACES,IAAI,EAAEd,GAAG,CAACE;MACZ,CAAC,EACD;QAAEa,GAAG,EAAE;MAAK,CAAC,CACd;MACD,OAAOd,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACN,WAAW,CAAC;IAC1C,CAAC,CAAC,OAAOO,GAAG,EAAE;MACZjB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACC,GAAG,CAAC;IAC3B;EACF,CAAC,MAAM;IACL,OAAOjB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,mCAAmC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACApB,MAAM,CAACsB,MAAM,CAAC,MAAM,EAAE,OAAOnB,GAAG,EAAEC,GAAG,KAAK;EACxC,IAAID,GAAG,CAACE,IAAI,CAACC,MAAM,KAAKH,GAAG,CAACI,MAAM,CAACC,EAAE,EAAE;IACrC,IAAI;MACF,MAAMe,IAAI,GAAG,MAAMR,aAAI,CAACS,QAAQ,CAACrB,GAAG,CAACI,MAAM,CAACC,EAAE,CAAC;MAC/C,MAAMO,aAAI,CAACU,iBAAiB,CAACtB,GAAG,CAACI,MAAM,CAACC,EAAE,CAAC;MAC1C,OAAOJ,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,0BAA0B,CAAC;MACxD;MACA;MACA;MACA;MACA;MACA;MACA;IACF,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZ,OAAOjB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,iBAAiB,CAAC;IAChD;EACF,CAAC,MAAM;IACL,OAAOhB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,mCAAmC,CAAC;EAClE;AACF,CAAC,CAAC;;AAEF;AACApB,MAAM,CAAC0B,GAAG,CAAC,MAAM,EAAE,OAAOvB,GAAG,EAAEC,GAAG,KAAK;EACrC,IAAI;IACF,MAAMmB,IAAI,GAAG,MAAMR,aAAI,CAACS,QAAQ,CAACrB,GAAG,CAACI,MAAM,CAACC,EAAE,CAAC;IAC/C,mBAAgCe,IAAI,CAACI,IAAI;MAAnC;QAAElB;MAAoB,CAAC;MAARmB,MAAM;IAC3B,OAAOxB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACQ,MAAM,CAAC;EACrC,CAAC,CAAC,OAAOP,GAAG,EAAE;IACZ,OAAOjB,GAAG,CAACe,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACC,GAAG,CAAC;EAClC;AACF,CAAC,CAAC;AAAC,eAEYrB,MAAM;AAAA"}